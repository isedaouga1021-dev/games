<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Mini Shogi</title>
<style>
  body { font-family:sans-serif; text-align:center; }
  .board { display:grid; grid-template-columns:repeat(3,80px); gap:5px; justify-content:center; margin-top:20px;}
  .cell { width:80px; height:80px; border:2px solid #333; font-size:28px; display:flex; align-items:center; justify-content:center; cursor:pointer;}
</style>
</head>
<body>

<h2>ãƒŸãƒ‹å°†æ£‹</h2>
<p>è‡ªåˆ†ï¼šçŽ‹ðŸ‘‘ é‡‘ðŸŸ¡ã€€ç›¸æ‰‹ï¼šçŽ‹â™š é‡‘ðŸ”µ</p>
<div class="board" id="board"></div>

<script>
const boardEl = document.getElementById("board");
let selected = null;

let board = [
  ["â™š","ðŸ”µ",""],
  ["","",""],
  ["","",""],
  ["","ðŸŸ¡","ðŸ‘‘"]
];

function drawBoard(){
  boardEl.innerHTML="";
  board.forEach((row,y)=>{
    row.forEach((cell,x)=>{
      const div = document.createElement("div");
      div.className="cell";
      div.textContent=cell;
      div.onclick=()=>handleClick(x,y);
      boardEl.appendChild(div);
    });
  });
}

function handleClick(x,y){
  if(selected){
    movePiece(selected.x, selected.y, x, y, true);
    selected=null;
    setTimeout(cpuMove,500);
  }else{
    if(board[y][x]=="ðŸ‘‘"||board[y][x]=="ðŸŸ¡"){
      selected={x,y};
    }
  }
}

function movePiece(sx,sy,tx,ty,isPlayer){
  const target=board[ty][tx];
  if(isPlayer && target=="â™š"){ alert("å‹ã¡ï¼"); location.reload(); }
  if(!isPlayer && target=="ðŸ‘‘"){ alert("è² ã‘ï¼"); location.reload(); }

  board[ty][tx]=board[sy][sx];
  board[sy][sx]="";
  drawBoard();
}

function cpuMove(){
  let moves=[];
  board.forEach((row,y)=>{
    row.forEach((cell,x)=>{
      if(cell=="â™š"||cell=="ðŸ”µ"){
        [[0,1],[1,0],[-1,0],[0,-1]].forEach(d=>{
          let nx=x+d[0], ny=y+d[1];
          if(board[ny] && board[ny][nx]!==undefined && !(board[ny][nx]=="â™š"||board[ny][nx]=="ðŸ”µ")){
            moves.push({sx:x,sy:y,tx:nx,ty:ny});
          }
        });
      }
    });
  });
  if(moves.length){
    const m=moves[Math.floor(Math.random()*moves.length)];
    movePiece(m.sx,m.sy,m.tx,m.ty,false);
  }
}

drawBoard();
</script>
</body>
</html>
